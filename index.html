<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Monte seu Bolo - Confeitaria Fafa</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #f8f8f8;
            min-height: 100vh;
            padding-bottom: 80px;
        }

        .header {
            background: #fff;
            padding: 1rem;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            font-size: 1.25rem;
            font-weight: 700;
            color: #ea1d2c;
        }

        .btn-admin {
            padding: 0.5rem 1rem;
            background: #ea1d2c;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 0.875rem;
            font-weight: 600;
            cursor: pointer;
        }

        .container {
            padding: 1rem;
            max-width: 600px;
            margin: 0 auto;
        }

        .progress-bar {
            background: #fff;
            padding: 1rem;
            border-radius: 12px;
            margin-bottom: 1rem;
            box-shadow: 0 2px 8px rgba(0,0,0,0.06);
        }

        .progress-steps {
            display: flex;
            align-items: center;
            justify-content: space-between;
            position: relative;
        }

        .progress-line {
            position: absolute;
            top: 18px;
            left: 40px;
            right: 40px;
            height: 2px;
            background: #e0e0e0;
            z-index: 0;
        }

        .progress-line-fill {
            height: 100%;
            background: #ea1d2c;
            transition: width 0.3s;
        }

        .progress-step {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.5rem;
            position: relative;
            z-index: 1;
        }

        .step-circle {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background: #e0e0e0;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 0.875rem;
            color: #999;
            transition: all 0.3s;
        }

        .progress-step.active .step-circle {
            background: #ea1d2c;
            color: white;
        }

        .progress-step.completed .step-circle {
            background: #00a65a;
            color: white;
        }

        .step-label {
            font-size: 0.75rem;
            color: #666;
            font-weight: 500;
        }

        .progress-step.active .step-label {
            color: #ea1d2c;
            font-weight: 600;
        }

        .section-title {
            font-size: 1.25rem;
            font-weight: 700;
            color: #333;
            margin-bottom: 1rem;
        }

        .options-list {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }

        .option-item {
            background: #fff;
            border-radius: 12px;
            padding: 1rem;
            display: flex;
            gap: 1rem;
            cursor: pointer;
            transition: all 0.2s;
            border: 2px solid transparent;
            box-shadow: 0 2px 8px rgba(0,0,0,0.06);
        }

        .option-item:active {
            transform: scale(0.98);
        }

        .option-item.selected {
            border-color: #ea1d2c;
            background: #fff5f5;
        }

        .option-image {
            width: 80px;
            height: 80px;
            border-radius: 8px;
            object-fit: cover;
            flex-shrink: 0;
        }

        .option-info {
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .option-name {
            font-size: 1rem;
            font-weight: 600;
            color: #333;
            margin-bottom: 0.25rem;
        }

        .option-description {
            font-size: 0.875rem;
            color: #666;
            margin-bottom: 0.5rem;
        }

        .option-price {
            font-size: 1.125rem;
            font-weight: 700;
            color: #ea1d2c;
        }

        .option-radio {
            width: 24px;
            height: 24px;
            border: 2px solid #ddd;
            border-radius: 50%;
            flex-shrink: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
        }

        .option-item.selected .option-radio {
            border-color: #ea1d2c;
            background: #ea1d2c;
        }

        .option-item.selected .option-radio::after {
            content: '‚úì';
            color: white;
            font-size: 0.875rem;
            font-weight: 700;
        }

        .bottom-bar {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: #fff;
            padding: 1rem;
            box-shadow: 0 -2px 12px rgba(0,0,0,0.1);
            z-index: 99;
        }

        .bottom-content {
            max-width: 600px;
            margin: 0 auto;
            display: flex;
            gap: 1rem;
            align-items: center;
        }

        .total-info {
            flex: 1;
        }

        .total-label {
            font-size: 0.75rem;
            color: #666;
            margin-bottom: 0.25rem;
        }

        .total-price {
            font-size: 1.5rem;
            font-weight: 700;
            color: #333;
        }

        .btn-continue {
            padding: 1rem 2rem;
            background: #ea1d2c;
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 1rem;
            font-weight: 700;
            cursor: pointer;
            white-space: nowrap;
            transition: all 0.2s;
        }

        .btn-continue:disabled {
            background: #ccc;
            cursor: not-allowed;
        }

        .btn-continue:active:not(:disabled) {
            transform: scale(0.95);
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
            align-items: flex-end;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: #fff;
            border-radius: 20px 20px 0 0;
            padding: 1.5rem;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            animation: slideUp 0.3s;
        }

        @keyframes slideUp {
            from { transform: translateY(100%); }
            to { transform: translateY(0); }
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .modal-title {
            font-size: 1.25rem;
            font-weight: 700;
        }

        .close-btn {
            background: none;
            border: none;
            font-size: 1.5rem;
            color: #666;
            cursor: pointer;
            padding: 0.5rem;
        }

        .summary-item {
            padding: 1rem;
            background: #f8f8f8;
            border-radius: 8px;
            margin-bottom: 0.75rem;
        }

        .summary-label {
            font-size: 0.875rem;
            color: #666;
            margin-bottom: 0.25rem;
        }

        .summary-value {
            font-size: 1rem;
            font-weight: 600;
            color: #333;
        }

        .payment-notice {
            background: #fff3cd;
            border-left: 4px solid #f39c12;
            padding: 1rem;
            border-radius: 8px;
            margin: 1rem 0;
            font-size: 0.875rem;
            color: #856404;
        }

        .btn-whatsapp {
            width: 100%;
            padding: 1rem;
            background: #25D366;
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 1rem;
            font-weight: 700;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }

        .form-group {
            margin-bottom: 1rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
            color: #333;
        }

        .form-group input,
        .form-group textarea {
            width: 100%;
            padding: 0.75rem;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 1rem;
        }

        .admin-tabs {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1rem;
            overflow-x: auto;
            padding-bottom: 0.5rem;
        }

        .tab-btn {
            padding: 0.75rem 1.5rem;
            background: #fff;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-weight: 600;
            color: #666;
            white-space: nowrap;
            cursor: pointer;
        }

        .tab-btn.active {
            background: #ea1d2c;
            color: white;
            border-color: #ea1d2c;
        }

        .items-grid {
            display: grid;
            gap: 1rem;
        }

        .item-card {
            background: #fff;
            border-radius: 12px;
            padding: 1rem;
            box-shadow: 0 2px 8px rgba(0,0,0,0.06);
        }

        .item-image {
            width: 100%;
            height: 150px;
            object-fit: cover;
            border-radius: 8px;
            margin-bottom: 1rem;
        }

        .item-actions {
            display: flex;
            gap: 0.5rem;
            margin-top: 1rem;
        }

        .btn-edit,
        .btn-delete {
            flex: 1;
            padding: 0.5rem;
            border: none;
            border-radius: 6px;
            font-weight: 600;
            cursor: pointer;
        }

        .btn-edit {
            background: #f39c12;
            color: white;
        }

        .btn-delete {
            background: #dc3545;
            color: white;
        }

        .btn-add {
            width: 100%;
            padding: 1rem;
            background: #00a65a;
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 1rem;
            font-weight: 700;
            margin-bottom: 1rem;
            cursor: pointer;
        }

        .hidden {
            display: none !important;
        }

        .step-content {
            animation: fadeIn 0.3s;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="header-content">
            <div class="logo">üéÇ Confeitaria Fafa</div>
            <button class="btn-admin" onclick="showLogin()" id="adminBtn">üîê Admin</button>
        </div>
    </header>

    <div class="container">
        <div id="clientPage">
            <div class="progress-bar">
                <div class="progress-steps">
                    <div class="progress-line">
                        <div class="progress-line-fill" id="progressFill" style="width: 0%"></div>
                    </div>
                    <div class="progress-step active" data-step="massa">
                        <div class="step-circle">1</div>
                        <div class="step-label">Massa</div>
                    </div>
                    <div class="progress-step" data-step="recheio">
                        <div class="step-circle">2</div>
                        <div class="step-label">Recheio</div>
                    </div>
                    <div class="progress-step" data-step="cobertura">
                        <div class="step-circle">3</div>
                        <div class="step-label">Cobertura</div>
                    </div>
                </div>
            </div>

            <div id="stepMassa" class="step-content">
                <h2 class="section-title">Escolha a Massa</h2>
                <div class="options-list" id="massaOptions"></div>
            </div>

            <div id="stepRecheio" class="step-content hidden">
                <h2 class="section-title">Escolha o Recheio</h2>
                <div class="options-list" id="recheioOptions"></div>
            </div>

            <div id="stepCobertura" class="step-content hidden">
                <h2 class="section-title">Escolha a Cobertura</h2>
                <div class="options-list" id="coberturaOptions"></div>
            </div>
        </div>

        <div id="adminPage" class="hidden">
            <div class="admin-tabs">
                <button class="tab-btn active" onclick="showTab('massa')">üç∞ Massas</button>
                <button class="tab-btn" onclick="showTab('recheio')">üçì Recheios</button>
                <button class="tab-btn" onclick="showTab('cobertura')">üé® Coberturas</button>
            </div>

            <button class="btn-add" onclick="showItemForm()">‚ûï Adicionar Item</button>

            <div id="tabMassa" class="items-grid"></div>
            <div id="tabRecheio" class="items-grid hidden"></div>
            <div id="tabCobertura" class="items-grid hidden"></div>

            <button class="btn-admin" style="width: 100%; margin-top: 1rem;" onclick="logout()">Sair</button>
        </div>
    </div>

    <div class="bottom-bar" id="bottomBar">
        <div class="bottom-content">
            <div class="total-info">
                <div class="total-label">Total</div>
                <div class="total-price" id="totalPrice">R$ 0,00</div>
            </div>
            <button class="btn-continue" id="continueBtn" onclick="handleContinue()" disabled>
                Continuar
            </button>
        </div>
    </div>

    <div class="modal" id="summaryModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Resumo do Pedido</h3>
                <button class="close-btn" onclick="closeModal('summaryModal')">‚úï</button>
            </div>
            
            <div class="summary-item" onclick="editSelection('massa')" style="cursor: pointer;">
                <div style="flex: 1;">
                    <div class="summary-label">üç∞ Massa</div>
                    <div class="summary-value" id="summaryMassa">-</div>
                </div>
                <div style="color: #ea1d2c; font-size: 1.25rem;">‚úèÔ∏è</div>
            </div>
            
            <div class="summary-item" onclick="editSelection('recheio')" style="cursor: pointer;">
                <div style="flex: 1;">
                    <div class="summary-label">üçì Recheio</div>
                    <div class="summary-value" id="summaryRecheio">-</div>
                </div>
                <div style="color: #ea1d2c; font-size: 1.25rem;">‚úèÔ∏è</div>
            </div>
            
            <div class="summary-item" onclick="editSelection('cobertura')" style="cursor: pointer;">
                <div style="flex: 1;">
                    <div class="summary-label">üé® Cobertura</div>
                    <div class="summary-value" id="summaryCobertura">-</div>
                </div>
                <div style="color: #ea1d2c; font-size: 1.25rem;">‚úèÔ∏è</div>
            </div>

            <div class="payment-notice">
                <strong>‚ö†Ô∏è Importante:</strong> Pagamento de 50% como sinal. O restante na entrega.
            </div>

            <div style="text-align: center; margin: 1rem 0;">
                <div style="font-size: 0.875rem; color: #666;">Valor Total</div>
                <div style="font-size: 2rem; font-weight: 700; color: #ea1d2c;" id="summaryTotal">R$ 0,00</div>
            </div>

            <button class="btn-whatsapp" onclick="sendWhatsApp()">
                üì± Fazer Pedido pelo WhatsApp
            </button>
        </div>
    </div>

    <div class="modal" id="loginModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Login Admin</h3>
                <button class="close-btn" onclick="closeModal('loginModal')">‚úï</button>
            </div>
            <form onsubmit="handleLogin(event)">
                <div class="form-group">
                    <label>Usu√°rio</label>
                    <input type="text" id="loginUser" required>
                </div>
                <div class="form-group">
                    <label>Senha</label>
                    <input type="password" id="loginPassword" required>
                </div>
                <button type="submit" class="btn-whatsapp" style="background: #ea1d2c;">Entrar</button>
            </form>
        </div>
    </div>

    <div class="modal" id="itemModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title" id="itemModalTitle">Adicionar Item</h3>
                <button class="close-btn" onclick="closeModal('itemModal')">‚úï</button>
            </div>
            <form onsubmit="saveItem(event)">
                <div class="form-group">
                    <label>Nome</label>
                    <input type="text" id="itemName" required>
                </div>
                <div class="form-group">
                    <label>Descri√ß√£o</label>
                    <textarea id="itemDescription" rows="3"></textarea>
                </div>
                <div class="form-group">
                    <label>Pre√ßo (R$)</label>
                    <input type="number" id="itemPrice" step="0.01" required>
                </div>
                <div class="form-group">
                    <label>Imagem</label>
                    <input type="file" id="itemImage" accept="image/*" onchange="previewImage(event)">
                    <img id="imagePreview" style="width: 100%; margin-top: 1rem; border-radius: 8px; display: none;">
                </div>
                <button type="submit" class="btn-whatsapp" style="background: #00a65a;">Salvar</button>
            </form>
        </div>
    </div>

    <script>
        let currentUser = null;
        let currentTab = 'massa';
        let currentStep = 'massa';
        let editingItemId = null;
        
        let massas = [];
        let recheios = [];
        let coberturas = [];
        
        let selectedMassa = null;
        let selectedRecheio = null;
        let selectedCobertura = null;
        
        const WHATSAPP_NUMBER = '5561991944143';

        function loadData() {
            const defaultMassas = [
                { id: 1, name: 'Chocolate', description: 'Massa fofinha de chocolate belga', price: 25.00, image: 'data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" width="400" height="300"%3E%3Crect fill="%238B4513" width="400" height="300"/%3E%3Ctext x="50%25" y="50%25" text-anchor="middle" dy=".3em" fill="white" font-size="80"%3Eüç´%3C/text%3E%3C/svg%3E' },
                { id: 2, name: 'Baunilha', description: 'Massa cl√°ssica de baunilha', price: 20.00, image: 'data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" width="400" height="300"%3E%3Crect fill="%23F5DEB3" width="400" height="300"/%3E%3Ctext x="50%25" y="50%25" text-anchor="middle" dy=".3em" fill="white" font-size="80"%3Eüç∞%3C/text%3E%3C/svg%3E' }
            ];
            
            const defaultRecheios = [
                { id: 1, name: 'Brigadeiro', description: 'Cremoso brigadeiro gourmet', price: 15.00, image: 'data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" width="400" height="300"%3E%3Crect fill="%234B3621" width="400" height="300"/%3E%3Ctext x="50%25" y="50%25" text-anchor="middle" dy=".3em" fill="white" font-size="80"%3Eüç´%3C/text%3E%3C/svg%3E' },
                { id: 2, name: 'Doce de Leite', description: 'Doce de leite cremoso', price: 12.00, image: 'data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" width="400" height="300"%3E%3Crect fill="%23D2691E" width="400" height="300"/%3E%3Ctext x="50%25" y="50%25" text-anchor="middle" dy=".3em" fill="white" font-size="80"%3EüçØ%3C/text%3E%3C/svg%3E' }
            ];
            
            const defaultCoberturas = [
                { id: 1, name: 'Ganache', description: 'Chocolate meio amargo', price: 18.00, image: 'data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" width="400" height="300"%3E%3Crect fill="%233B2F2F" width="400" height="300"/%3E%3Ctext x="50%25" y="50%25" text-anchor="middle" dy=".3em" fill="white" font-size="80"%3Eüç´%3C/text%3E%3C/svg%3E' },
                { id: 2, name: 'Chantilly', description: 'Chantilly tradicional', price: 15.00, image: 'data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" width="400" height="300"%3E%3Crect fill="%23FFFAF0" width="400" height="300"/%3E%3Ctext x="50%25" y="50%25" text-anchor="middle" dy=".3em" fill="gray" font-size="80"%3E‚òÅÔ∏è%3C/text%3E%3C/svg%3E' }
            ];

            massas = JSON.parse(localStorage.getItem('massas')) || defaultMassas;
            recheios = JSON.parse(localStorage.getItem('recheios')) || defaultRecheios;
            coberturas = JSON.parse(localStorage.getItem('coberturas')) || defaultCoberturas;
            
            saveData();
        }

        function saveData() {
            localStorage.setItem('massas', JSON.stringify(massas));
            localStorage.setItem('recheios', JSON.stringify(recheios));
            localStorage.setItem('coberturas', JSON.stringify(coberturas));
        }

        function renderOptions(items, containerId, selectFunction) {
            const container = document.getElementById(containerId);
            const selected = currentStep === 'massa' ? selectedMassa : 
                           currentStep === 'recheio' ? selectedRecheio : selectedCobertura;
            
            container.innerHTML = items.map(item => `
                <div class="option-item ${selected?.id === item.id ? 'selected' : ''}" 
                     onclick="${selectFunction}(${item.id})">
                    <img src="${item.image}" alt="${item.name}" class="option-image">
                    <div class="option-info">
                        <div class="option-name">${item.name}</div>
                        <div class="option-description">${item.description}</div>
                        <div class="option-price">R$ ${item.price.toFixed(2)}</div>
                    </div>
                    <div class="option-radio"></div>
                </div>
            `).join('');
        }

        function selectMassa(id) {
            selectedMassa = massas.find(m => m.id === id);
            renderOptions(massas, 'massaOptions', 'selectMassa');
            updateBottomBar();
        }

        function selectRecheio(id) {
            selectedRecheio = recheios.find(r => r.id === id);
            renderOptions(recheios, 'recheioOptions', 'selectRecheio');
            updateBottomBar();
        }

        function selectCobertura(id) {
            selectedCobertura = coberturas.find(c => c.id === id);
            renderOptions(coberturas, 'coberturaOptions', 'selectCobertura');
            updateBottomBar();
        }

        function updateBottomBar() {
            const total = (selectedMassa?.price || 0) + (selectedRecheio?.price || 0) + (selectedCobertura?.price || 0);
            document.getElementById('totalPrice').textContent = `R$ ${total.toFixed(2)}`;
            
            const continueBtn = document.getElementById('continueBtn');
            if (currentStep === 'massa' && selectedMassa) {
                continueBtn.disabled = false;
            } else if (currentStep === 'recheio' && selectedRecheio) {
                continueBtn.disabled = false;
            } else if (currentStep === 'cobertura' && selectedCobertura) {
                continueBtn.disabled = false;
                continueBtn.textContent = 'Ver Resumo';
            } else {
                continueBtn.disabled = true;
            }
        }

        function handleContinue() {
            if (currentStep === 'massa') {
                showStepContent('recheio');
            } else if (currentStep === 'recheio') {
                showStepContent('cobertura');
            } else if (currentStep === 'cobertura') {
                showSummary();
            }
        }

        function showStepContent(step) {
            currentStep = step;
            
            document.getElementById('stepMassa').classList.add('hidden');
            document.getElementById('stepRecheio').classList.add('hidden');
            document.getElementById('stepCobertura').classList.add('hidden');
            document.getElementById(`step${step.charAt(0).toUpperCase() + step.slice(1)}`).classList.remove('hidden');
            
            const steps = document.querySelectorAll('.progress-step');
            steps.forEach(s => {
                s.classList.remove('active', 'completed');
                const stepName = s.dataset.step;
                if (stepName === step) {
                    s.classList.add('active');
                } else if ((step === 'recheio' && stepName === 'massa') || 
                          (step === 'cobertura' && (stepName === 'massa' || stepName === 'recheio'))) {
                    s.classList.add('completed');
                }
            });
            
            const progress = step === 'massa' ? 0 : step === 'recheio' ? 50 : 100;
            document.getElementById('progressFill').style.width = progress + '%';
            
            document.getElementById('continueBtn').textContent = step === 'cobertura' ? 'Ver Resumo' : 'Continuar';
            updateBottomBar();
        }

        function showSummary() {
            document.getElementById('summaryMassa').textContent = `${selectedMassa.name} - R$ ${selectedMassa.price.toFixed(2)}`;
            document.getElementById('summaryRecheio').textContent = `${selectedRecheio.name} - R$ ${selectedRecheio.price.toFixed(2)}`;
            document.getElementById('summaryCobertura').textContent = `${selectedCobertura.name} - R$ ${selectedCobertura.price.toFixed(2)}`;
            
            const total = selectedMassa.price + selectedRecheio.price + selectedCobertura.price;
            document.getElementById('summaryTotal').textContent = `R$ ${total.toFixed(2)}`;
            
            document.getElementById('summaryModal').classList.add('active');
        }

        function sendWhatsApp() {
            const total = selectedMassa.price + selectedRecheio.price + selectedCobertura.price;
            const sinal = total * 0.5;

            let message = 'üéÇ *Novo Pedido - Confeitaria Fafa*\n\n';
            message += '*MEU BOLO PERSONALIZADO:*\n\n';
            message += `üç∞ *Massa:* ${selectedMassa.name}\n`;
            message += `   R$ ${selectedMassa.price.toFixed(2)}\n\n`;
            message += `üçì *Recheio:* ${selectedRecheio.name}\n`;
            message += `   R$ ${selectedRecheio.price.toFixed(2)}\n\n`;
            message += `üé® *Cobertura:* ${selectedCobertura.name}\n`;
            message += `   R$ ${selectedCobertura.price.toFixed(2)}\n\n`;
            message += `‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n`;
            message += `üí∞ *VALOR TOTAL: R$ ${total.toFixed(2)}*\n\n`;
            message += `‚ö†Ô∏è *IMPORTANTE:*\n`;
            message += `üìå Sinal de 50%: *R$ ${sinal.toFixed(2)}*\n`;
            message += `üìå Restante na entrega: R$ ${(total - sinal).toFixed(2)}`;

            const url = `https://wa.me/${WHATSAPP_NUMBER}?text=${encodeURIComponent(message)}`;
            window.open(url, '_blank');
        }

        function showLogin() {
            document.getElementById('loginModal').classList.add('active');
        }

        function handleLogin(event) {
            event.preventDefault();
            const user = document.getElementById('loginUser').value;
            const password = document.getElementById('loginPassword').value;

            if (user.toLowerCase() === 'fafa' && password === '1050') {
                currentUser = { user: 'fafa' };
                closeModal('loginModal');
                showAdminPage();
            } else {
                alert('Usu√°rio ou senha incorretos!');
            }
        }

        function showAdminPage() {
            document.getElementById('clientPage').classList.add('hidden');
            document.getElementById('adminPage').classList.remove('hidden');
            document.getElementById('bottomBar').classList.add('hidden');
            document.getElementById('adminBtn').textContent = 'üë§ ' + currentUser.user;
            renderAdminItems();
        }

        function logout() {
            currentUser = null;
            document.getElementById('clientPage').classList.remove('hidden');
            document.getElementById('adminPage').classList.add('hidden');
            document.getElementById('bottomBar').classList.remove('hidden');
            document.getElementById('adminBtn').textContent = 'üîê Admin';
        }

        function showTab(tab) {
            currentTab = tab;
            
            document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
            document.getElementById('tabMassa').classList.add('hidden');
            document.getElementById('tabRecheio').classList.add('hidden');
            document.getElementById('tabCobertura').classList.add('hidden');
            
            if (tab === 'massa') {
                document.querySelectorAll('.tab-btn')[0].classList.add('active');
                document.getElementById('tabMassa').classList.remove('hidden');
            } else if (tab === 'recheio') {
                document.querySelectorAll('.tab-btn')[1].classList.add('active');
                document.getElementById('tabRecheio').classList.remove('hidden');
            } else if (tab === 'cobertura') {
                document.querySelectorAll('.tab-btn')[2].classList.add('active');
                document.getElementById('tabCobertura').classList.remove('hidden');
            }
            
            renderAdminItems();
        }

        function renderAdminItems() {
            renderAdminList('massa', massas, 'tabMassa');
            renderAdminList('recheio', recheios, 'tabRecheio');
            renderAdminList('cobertura', coberturas, 'tabCobertura');
        }

        function renderAdminList(type, items, containerId) {
            const container = document.getElementById(containerId);
            container.innerHTML = items.map(item => `
                <div class="item-card">
                    <img src="${item.image}" alt="${item.name}" class="item-image">
                    <div style="font-size: 1.125rem; font-weight: 600; margin-bottom: 0.25rem;">${item.name}</div>
                    <div style="font-size: 0.875rem; color: #666; margin-bottom: 0.5rem;">${item.description}</div>
                    <div style="font-size: 1.25rem; font-weight: 700; color: #ea1d2c;">R$ ${item.price.toFixed(2)}</div>
                    <div class="item-actions">
                        <button class="btn-edit" onclick="editItem('${type}', ${item.id})">‚úèÔ∏è Editar</button>
                        <button class="btn-delete" onclick="deleteItem('${type}', ${item.id})">üóëÔ∏è Excluir</button>
                    </div>
                </div>
            `).join('');
        }

        function showItemForm(type = null, id = null) {
            editingItemId = id;
            
            if (id) {
                let item;
                if (currentTab === 'massa') item = massas.find(m => m.id === id);
                if (currentTab === 'recheio') item = recheios.find(r => r.id === id);
                if (currentTab === 'cobertura') item = coberturas.find(c => c.id === id);
                
                if (item) {
                    document.getElementById('itemModalTitle').textContent = 'Editar Item';
                    document.getElementById('itemName').value = item.name;
                    document.getElementById('itemDescription').value = item.description || '';
                    document.getElementById('itemPrice').value = item.price;
                    
                    const preview = document.getElementById('imagePreview');
                    preview.src = item.image;
                    preview.style.display = 'block';
                }
            } else {
                document.getElementById('itemModalTitle').textContent = 'Adicionar Item';
                document.getElementById('itemName').value = '';
                document.getElementById('itemDescription').value = '';
                document.getElementById('itemPrice').value = '';
                document.getElementById('imagePreview').style.display = 'none';
            }
            
            document.getElementById('itemModal').classList.add('active');
        }

        function previewImage(event) {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const preview = document.getElementById('imagePreview');
                    preview.src = e.target.result;
                    preview.style.display = 'block';
                };
                reader.readAsDataURL(file);
            }
        }

        function saveItem(event) {
            event.preventDefault();
            
            const name = document.getElementById('itemName').value;
            const description = document.getElementById('itemDescription').value;
            const price = parseFloat(document.getElementById('itemPrice').value);
            const imageFile = document.getElementById('itemImage').files[0];
            
            const processItem = (imageData) => {
                const defaultImages = {
                    massa: 'data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" width="400" height="300"%3E%3Crect fill="%23F5DEB3" width="400" height="300"/%3E%3Ctext x="50%25" y="50%25" text-anchor="middle" dy=".3em" fill="white" font-size="80"%3Eüç∞%3C/text%3E%3C/svg%3E',
                    recheio: 'data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" width="400" height="300"%3E%3Crect fill="%23FF69B4" width="400" height="300"/%3E%3Ctext x="50%25" y="50%25" text-anchor="middle" dy=".3em" fill="white" font-size="80"%3Eüçì%3C/text%3E%3C/svg%3E',
                    cobertura: 'data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" width="400" height="300"%3E%3Crect fill="%238B4513" width="400" height="300"/%3E%3Ctext x="50%25" y="50%25" text-anchor="middle" dy=".3em" fill="white" font-size="80"%3Eüé®%3C/text%3E%3C/svg%3E'
                };

                if (editingItemId) {
                    if (currentTab === 'massa') {
                        const index = massas.findIndex(m => m.id === editingItemId);
                        massas[index] = { ...massas[index], name, description, price, image: imageData || massas[index].image };
                    } else if (currentTab === 'recheio') {
                        const index = recheios.findIndex(r => r.id === editingItemId);
                        recheios[index] = { ...recheios[index], name, description, price, image: imageData || recheios[index].image };
                    } else if (currentTab === 'cobertura') {
                        const index = coberturas.findIndex(c => c.id === editingItemId);
                        coberturas[index] = { ...coberturas[index], name, description, price, image: imageData || coberturas[index].image };
                    }
                } else {
                    const newItem = { id: Date.now(), name, description, price, image: imageData || defaultImages[currentTab] };
                    if (currentTab === 'massa') massas.push(newItem);
                    if (currentTab === 'recheio') recheios.push(newItem);
                    if (currentTab === 'cobertura') coberturas.push(newItem);
                }
                
                saveData();
                closeModal('itemModal');
                renderAdminItems();
                renderOptions(massas, 'massaOptions', 'selectMassa');
                renderOptions(recheios, 'recheioOptions', 'selectRecheio');
                renderOptions(coberturas, 'coberturaOptions', 'selectCobertura');
                
                event.target.reset();
                document.getElementById('imagePreview').style.display = 'none';
            };

            if (imageFile) {
                const reader = new FileReader();
                reader.onload = function(e) { processItem(e.target.result); };
                reader.readAsDataURL(imageFile);
            } else {
                processItem(null);
            }
        }

        function editItem(type, id) {
            showItemForm(type, id);
        }

        function deleteItem(type, id) {
            if (!confirm('Excluir este item?')) return;
            
            if (type === 'massa') massas = massas.filter(m => m.id !== id);
            else if (type === 'recheio') recheios = recheios.filter(r => r.id !== id);
            else if (type === 'cobertura') coberturas = coberturas.filter(c => c.id !== id);
            
            saveData();
            renderAdminItems();
            renderOptions(massas, 'massaOptions', 'selectMassa');
            renderOptions(recheios, 'recheioOptions', 'selectRecheio');
            renderOptions(coberturas, 'coberturaOptions', 'selectCobertura');
        }

        function closeModal(modalId) {
            document.getElementById(modalId).classList.remove('active');
        }

        window.onclick = function(event) {
            if (event.target.classList.contains('modal')) {
                event.target.classList.remove('active');
            }
        };

        loadData();
        renderOptions(massas, 'massaOptions', 'selectMassa');
        renderOptions(recheios, 'recheioOptions', 'selectRecheio');
        renderOptions(coberturas, 'coberturaOptions', 'selectCobertura');
    </script>
</body>
</html>
